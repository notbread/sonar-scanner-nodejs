sudo: required
services:
  - docker
env:
  global:
    - secure: "sqOyunIHPK4bMItZ20hNA9GNB0F7XClm4Ov4a96JJlYs0/RIVzcQcRvW4zhLm2Iex6eSfTaxazBn8GhnaEnujMhavjD+ePmpwEMeBYsrhk+z1Hx/u51vxQVmwhF9cJ8bSDAnLkJseV0oRaons3J0BlD3pIpU5Ow6rlr6Dt41cX9v3USGKUREa+KciDZUm7WRGrrjqFuyDNfvy8pPairQxNV77sPRVs4f58zWQPjLo0MctBJo1BQkIlrs+Pz1mVXglLJ5REnUJrYzfDeh5MeKAznZCUhfbjDpRa+5MBJUrMs9HAQrmUckn0QBuyP5+YfvXOFhGjDK1iqAk52IFkPRRJa+ecUzgUddsEUQB0pScoglRMS09Qh/ZEUj0zBmLY79+bpdjFyPTHMlVVSywKDlK9AXJxMN6skkH4f88ps6xJiQkEgpoXdqj2ylaOUm/BXSChA/CCK0HK3yM0rWH8EYWr63hU/ReCehkM+0Br+YPOPq8IwGNQwVBPflOWznQ/6AgnEr/PFw/Ksur7D8l687srTyIDliXyHSoSNjXZs4rpgsGqMYb7kyeUw8PJFGYrBWlgtRLkj7GAnVcdLDzRCC9iKrUiqBHDOqCTqxcK+kFTcgjBzzg6dS9x93pwgVJZRzoLNv/Fty8sn4TLtx74oS0esQ8YwDRif+UecgPNS63rk="
    - REGISTRY_USER=traviscisakson


before_script:
  - docker pull sakson/sonar-scanner-nodejs || true
script:
  - docker build --pull --cache-from sakson/sonar-scanner-nodejs --tag sakson/sonar-scanner-nodejs .

after_script:
  - docker images

before_deploy:
  - docker login -u "$REGISTRY_USER" --password-stdin -p "$REGISTRY_PASS"
deploy:
  provider: script
  script: docker push sakson/sonar-scanner-nodejs
  on:
    branch: master
